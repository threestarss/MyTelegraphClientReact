(this.webpackJsonpmytelegraphclientreact=this.webpackJsonpmytelegraphclientreact||[]).push([[0],{15:function(e,t,r){},18:function(e,t,r){"use strict";r.r(t);var n=r(1),c=r.n(n),a=r(8),s=r.n(a),o=(r(15),r(3)),i=r.n(o),l=r(5),u=r(4),j=r(2),b=r(0),h=Object(n.createContext)();function p(e){var t=e.children,r=Object(n.useState)(),c=Object(j.a)(r,2),a=c[0],s=c[1],o=Object(n.useState)([]),i=Object(j.a)(o,2),l=i[0],u=i[1],p=Object(n.useState)({query:"",serp:[]}),d=Object(j.a)(p,2),m=d[0],f=d[1],O=Object(n.useState)(0),g=Object(j.a)(O,2),k=g[0],x=g[1],v=Object(n.useState)(!1),w=Object(j.a)(v,2),S=w[0],y=w[1];return Object(b.jsx)(h.Provider,{value:{article:a,bookmarks:l,scrollPos:k,searchResults:m,showError:S,setArticle:s,setBookmarks:u,setScrollPos:x,setSearchResults:f,setShowError:y},children:t})}function d(){return Object(n.useContext)(h)}var m=function(e){var t=e.link,r=d().bookmarks;return Object(b.jsx)("button",{className:"".concat(function(e,t){return t.some((function(t){return t.link===e}))}(t,r)?"marked":""," bookmark-btn"),children:Object(b.jsx)("i",{className:"fas fa-bookmark"})})};var f=function(e){var t=e.link,r=e.img,n=e.title,c=e.snippet;return Object(b.jsxs)("div",{className:"row bookmark g-0","data-link":t,children:[Object(b.jsx)("div",{className:"col-4",children:Object(b.jsx)("img",{src:r,alt:""})}),Object(b.jsxs)("div",{className:"bookmark-text col-8",children:[Object(b.jsx)(m,{link:t}),Object(b.jsx)("h5",{children:n}),Object(b.jsx)("p",{children:c})]})]})};var O=function(e){var t=e.appMode,r=d(),c=r.bookmarks,a=r.setBookmarks,s=r.setArticle,o=Object(j.a)(t,2)[1];Object(n.useEffect)((function(){localStorage.bookmarks||localStorage.setItem("bookmarks",JSON.stringify([])),a(JSON.parse(localStorage.getItem("bookmarks")))}),[a]);var h=c.map((function(e){return Object(n.createElement)(f,Object(u.a)(Object(u.a)({},e),{},{key:e.link}))}));function p(){return(p=Object(l.a)(i.a.mark((function e(t){var r,n,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.target.closest(".bookmark")){e.next=2;break}return e.abrupt("return");case 2:if(r=t.target.closest(".bookmark"),n=r.dataset.link,!(t.target.parentElement instanceof HTMLButtonElement)){e.next=8;break}g(n),e.next=13;break;case 8:return e.next=10,m(n);case 10:c=e.sent,s(Object.assign({},c)),o(!0);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(b.jsxs)("div",{className:"bookmark-container col-3",onClick:function(e){return p.apply(this,arguments)},children:[Object(b.jsx)("div",{className:"bookmark-header border-left ps-2",children:Object(b.jsx)("h2",{children:"Bookmarks"})}),Object(b.jsx)("aside",{className:"bookmark-menu",children:h})]});function m(e){return O.apply(this,arguments)}function O(){return(O=Object(l.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.telegra.ph/getPage/".concat(k(t),"?return_content=true"));case 2:return r=e.sent,e.next=5,r.json();case 5:return n=e.sent,e.abrupt("return",n.result);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){a((function(t){var r=t.filter((function(t){return t.link!==e}));return localStorage.setItem("bookmarks",JSON.stringify(r)),r}))}function k(e){return e.startsWith("https")?e.slice(19):e.slice(18)}},g=r(6);var k=function(e,t,r,n){this.link=e,this.img=t,this.title=r,this.snippet=n};var x=function(e){var t=e.title,r=e.author,n=e.link,c=e.img,a=e.snippet,s=d(),o=s.bookmarks,i=s.setBookmarks;return Object(b.jsxs)("header",{className:"article-header","data-link":n.toLowerCase(),"data-title":t,"data-snippet":a,"data-img":c,onClick:function(e){if(!e.target.closest(".card"))return;var t=e.target.parentElement.classList,r=e.target.closest(".card").dataset,n=r.link,c=r.img,a=r.title,s=r.snippet;if(e.target.parentElement instanceof HTMLButtonElement){if(t.contains("marked"))return t.toggle("marked"),void function(e){i((function(t){var r=t.filter((function(t){return t.link!==e}));return localStorage.setItem("bookmarks",JSON.stringify(r)),r}))}(n);(function(e,t){return t.some((function(t){return t.link===e}))})(n,o)||(t.toggle("marked"),function(e,t,r,n){i((function(c){var a=[].concat(Object(g.a)(c),[new k(e,t,r,n)]);return localStorage.setItem("bookmarks",JSON.stringify(a)),a}))}(n,c,a,s))}},children:[Object(b.jsx)(m,{link:n.toLowerCase()}),Object(b.jsx)("h3",{children:t}),Object(b.jsx)("p",{children:r})]})};var v=function e(t){var r=t.tag,c=t.children,a=void 0===c?[]:c,s=t.attrs,o=a.map((function(t,r){return"\n"===t||"br"===t.tag?Object(b.jsx)("br",{}):"hr"===t.tag?Object(b.jsx)("hr",{}):"string"===typeof t?t:"img"===t.tag?Object(n.createElement)(t.tag,{src:"".concat(t.attrs.src.startsWith("/")?"https://telegra.ph"+t.attrs.src:t.attrs.src)}):Object(n.createElement)(e,Object(u.a)(Object(u.a)({},t),{},{key:r}))}));return Object(n.createElement)(r,s,o)};var w=function(e){var t=e.article,r=e.appMode,c=d().searchResults,a=Object(j.a)(r,2)[1],s=document.querySelector(".main-container"),o=t.content.map((function(e,t){return"img"===e.tag?Object(n.createElement)(e.tag,e.attrs):"br"===e.tag?Object(b.jsx)("br",{}):"hr"===e.tag?Object(b.jsx)("hr",{}):Object(n.createElement)(v,Object(u.a)(Object(u.a)({},e),{},{key:t}))}));return console.log(t),Object(n.useEffect)((function(){s.scrollTo(0,0)})),Object(b.jsx)("div",{className:"article-container",children:Object(b.jsxs)("article",{children:[Object(b.jsx)("button",{className:"go-back-btn",onClick:function(){0!==c.serp.length?a(!1):a(null)},children:"Go Back"}),Object(b.jsx)(x,{title:t.title,author:t.author_name,link:t.url,img:t.image_url,snippet:t.description}),o]})})};var S=function(e){var t=e.title,r=e.snippet,n=e.link,c=e.pagemap,a=c.cse_thumbnail;a=void 0===a?[]:a;var s=Object(j.a)(a,1)[0],o=(s=void 0===s?{}:s).src,i=c.cse_image;i=void 0===i?[]:i;var l=Object(j.a)(i,1)[0],u=(l=void 0===l?{}:l).src,h="/src/placeholder.png";function p(e){return e.slice(0,e.length-11)}return Object(b.jsx)("div",{className:"col mt-2 mb-3",children:Object(b.jsxs)("div",{className:"card","data-link":n.toLowerCase(),"data-img":o||u||h,"data-title":p(t),"data-snippet":r,children:[Object(b.jsx)(m,{link:n.toLowerCase()}),Object(b.jsx)("div",{className:"img-container",children:Object(b.jsx)("img",{className:"card-img-top",src:o||u||h,alt:""})}),Object(b.jsxs)("div",{className:"card-body",children:[Object(b.jsx)("h5",{children:p(t)}),Object(b.jsx)("p",{children:r})]})]})})};var y=function(e){var t=e.appMode,r=e.serp,c=d(),a=c.bookmarks,s=c.scrollPos,o=c.setBookmarks,h=c.setArticle,p=Object(j.a)(t,2)[1],m=document.querySelector(".main-container");return Object(n.useEffect)((function(){m.scrollTo(0,s)}),[s,m]),Object(b.jsx)("div",{className:"card-container row row-cols-1 row-cols-xxl-4 row-cols-xl-3 row-cols-lg-3 row-cols-md-2 row-cols-sm-1",onClick:function(e){return f.apply(this,arguments)},children:r.map((function(e,t){return Object(n.createElement)(S,Object(u.a)(Object(u.a)({},e),{},{key:t+1}))}))});function f(){return(f=Object(l.a)(i.a.mark((function e(t){var r,n,c,s,o,l,u,j;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.target.closest(".card")){e.next=2;break}return e.abrupt("return");case 2:if(r=t.target.parentElement.classList,n=t.target.closest(".card"),c=n.dataset,s=c.link,o=c.img,l=c.title,u=c.snippet,!(t.target.parentElement instanceof HTMLButtonElement)){e.next=13;break}if(!r.contains("marked")){e.next=10;break}return r.toggle("marked"),w(s),e.abrupt("return");case 10:y(s,a)||(r.toggle("marked"),v(s,o,l,u)),e.next=18;break;case 13:return e.next=15,O(s);case 15:j=e.sent,h(Object.assign({},j)),p(!0);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e){return x.apply(this,arguments)}function x(){return(x=Object(l.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.telegra.ph/getPage/".concat(N(t),"?return_content=true"));case 2:return r=e.sent,e.next=5,r.json();case 5:return n=e.sent,e.abrupt("return",n.result);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e,t,r,n){o((function(c){var a=[].concat(Object(g.a)(c),[new k(e,t,r,n)]);return localStorage.setItem("bookmarks",JSON.stringify(a)),a}))}function w(e){o((function(t){var r=t.filter((function(t){return t.link!==e}));return localStorage.setItem("bookmarks",JSON.stringify(r)),r}))}function y(e,t){return t.some((function(t){return t.link===e}))}function N(e){return e.startsWith("https")?e.slice(19):e.slice(18)}};var N=function(){return Object(b.jsxs)("div",{className:"welcome-msg",children:[Object(b.jsx)("h2",{children:"Welcome to threestarss' Telegra.ph Client!"}),Object(b.jsxs)("p",{children:["Use the ",Object(b.jsx)("b",{children:"left"})," input to search for articles on Telegra.ph (via Google Custom Search API), and the ",Object(b.jsx)("b",{children:"right"})," input to fetch articles with direct link (e.g. https://telegra.ph/Sample-Page-12-15) straight from Telegra.ph (via Telegra.ph API)"]}),Object(b.jsx)("p",{children:"Be careful when using Search! Telegra.ph is full of articles that contain malicious links! And unfortunately, I can't filter them out of SERP yet..."})]})};var E=function(e){var t=e.appMode,r=e.data,n=e.mode,c=e.serpStart,a=e.setSerpStart,s=d(),o=s.searchResults,u=s.setSearchResults;return Object(b.jsx)("main",{className:"content-container container-fluid g-0",children:Object(b.jsxs)("div",{id:"parent",children:[null===n&&Object(b.jsx)(N,{}),!0===n&&Object(b.jsx)(w,{article:r,appMode:t}),!1===n&&Object(b.jsx)(y,{serp:o.serp,appMode:t}),!1===n&&Object(b.jsx)("button",{onClick:function(e){return j.apply(this,arguments)},id:"loadmore",children:"Load More Results"})]})});function j(){return(j=Object(l.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://www.googleapis.com/customsearch/v1?key=AIzaSyBit3zVmXZThAxAnPT_j8qBnrQgRN_IrRg&cx=0d7cbe59cd07cfd30&q=".concat(o.query,"&start=").concat(c));case 2:return r=e.sent,e.next=5,r.json();case 5:n=e.sent,u((function(e){return Object.assign(e,{serp:[].concat(Object(g.a)(e.serp),Object(g.a)(n.items))})})),a(c+10);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}};var C=function(e){var t=e.handleChange,r=e.handleSubmit,n=e.placeholder;return Object(b.jsx)("form",{className:"input",onSubmit:r,children:Object(b.jsx)("input",{className:"input",type:"text",placeholder:n,onChange:t})})};var T=function(e){var t=e.errorType,r=(e.children,d().setShowError),c=Object(n.useRef)(null),s=Object(n.useRef)(null),o=document.querySelector("#error-root");if(!s.current){var i=document.createElement("div");s.current=i}return Object(n.useEffect)((function(){o.append(s.current),c.current=setTimeout((function(){r(!1),o.removeChild(s.current)}),3500)}),[r]),Object(a.createPortal)(Object(b.jsx)("div",{className:"error",onClick:function(e){clearTimeout(c.current),r(!1),o.removeChild(s.current)},children:Object(b.jsxs)("p",{children:["search"===t?"Your search did not match any documents. Make sure that all words are spelled correctly.":null,"fetch"===t?"Page not found.":null]})}),s.current)};var P=function(e){var t=e.appMode,r=d(),c=r.article,a=r.searchResults,s=r.showError,o=r.setArticle,u=r.setScrollPos,h=r.setSearchResults,p=r.setShowError,m=Object(n.useState)(""),f=Object(j.a)(m,2),O=f[0],k=f[1],x=Object(n.useState)(""),v=Object(j.a)(x,2),w=v[0],S=v[1],y=Object(n.useState)(1),N=Object(j.a)(y,2),P=N[0],M=N[1],R=Object(j.a)(t,2),B=R[0],I=R[1],A=document.querySelector(".main-container");return Object(b.jsxs)("div",{className:"main-container col-9",onClick:function(e){if(!e.target.closest(".card"))return;u(A.scrollTop)},children:[Object(b.jsx)("header",{className:"bg-dark container-fluid align-items-center pe-0 g-0",children:Object(b.jsx)("div",{className:"row row-height",children:Object(b.jsxs)("div",{className:"header-menu col justify-content-between",children:[Object(b.jsx)("img",{className:"logo",alt:"logo",src:"./icon.png",onClick:function(){I(null)},width:"35",height:"35"}),Object(b.jsx)(C,{placeholder:"Telegra.ph search...",handleSubmit:function(e){return L.apply(this,arguments)},handleChange:function(e){h((function(t){return Object.assign(t,{query:"".concat(e.target.value)})}))}}),Object(b.jsx)(C,{placeholder:"URL of article...",handleSubmit:function(e){return q.apply(this,arguments)},handleChange:function(e){S(e.target.value)}})]})})}),s&&Object(b.jsx)(T,{errorType:O}),Object(b.jsx)(E,{appMode:t,data:c,mode:B,serpStart:P,setSerpStart:M})]});function q(){return(q=Object(l.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),k("fetch"),e.prev=2,e.next=5,fetch("https://api.telegra.ph/getPage/".concat(w.slice(19),"?return_content=true"));case 5:return r=e.sent,e.next=8,r.json();case 8:if(n=e.sent,console.log(n),n.ok){e.next=12;break}throw new Error("Page not found");case 12:o((function(){return Object.assign({},n.result)})),I(!0),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(2),p(!0),console.error(e.t0);case 20:case"end":return e.stop()}}),e,null,[[2,16]])})))).apply(this,arguments)}function L(){return(L=Object(l.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),k("search"),e.prev=2,e.next=5,fetch("https://www.googleapis.com/customsearch/v1?key=AIzaSyBit3zVmXZThAxAnPT_j8qBnrQgRN_IrRg&cx=0d7cbe59cd07cfd30&q=".concat(a.query,"&start=",1));case 5:return r=e.sent,e.next=8,r.json();case 8:if(n=e.sent,console.log(n),n.items){e.next=12;break}throw new Error("No results");case 12:M(1),h((function(e){return Object.assign(e,{serp:Object(g.a)(n.items)})})),I(!1),M((function(e){return e+10})),console.log(a),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(2),p(!0),console.log(e.t0.message);case 23:case"end":return e.stop()}}),e,null,[[2,19]])})))).apply(this,arguments)}};var M=function(){var e=Object(n.useState)(null);return Object(b.jsx)(p,{children:Object(b.jsxs)("div",{className:"row",children:[Object(b.jsx)(P,{appMode:e}),Object(b.jsx)(O,{appMode:e})]})})};s.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(M,{})}),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.5c9f0499.chunk.js.map