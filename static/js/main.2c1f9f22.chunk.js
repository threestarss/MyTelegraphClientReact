(this.webpackJsonpmytelegraphclientreact=this.webpackJsonpmytelegraphclientreact||[]).push([[0],{26:function(e,t,r){},38:function(e,t,r){"use strict";r.r(t);var n=r(1),c=r.n(n),a=r(8),o=r.n(a),s=(r(26),r(2)),i=r(10),l=r(3),u=r(7),b=r(18),j=r(19),p=Object(u.combineReducers)({appMode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{mode:null,error:!1,errorType:"",scrollPos:0},t=arguments.length>1?arguments[1]:void 0;if("ARTICLE_MODE"===t.type)return Object(l.a)(Object(l.a)({},e),{},{mode:!0});if("SEARCH_MODE"===t.type)return Object(l.a)(Object(l.a)({},e),{},{mode:!1});if("EDITOR_MODE"===t.type)return Object(l.a)(Object(l.a)({},e),{},{mode:null});if("ERROR_MODE"===t.type)return Object(l.a)(Object(l.a)({},e),{},{error:!e.error,errorType:t.payload});if("SET_SCROLL_POS"===t.type)return Object(l.a)(Object(l.a)({},e),{},{scrollPos:t.payload});return e},article:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if("ARTICLE_MODE"===t.type)return Object(l.a)(Object(l.a)({},e),t.payload);return e},bookmarks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{list:[]},t=arguments.length>1?arguments[1]:void 0;if("ADD_BOOKMARK"===t.type)return Object(l.a)(Object(l.a)({},e),{},{list:[].concat(Object(i.a)(e.list),Object(i.a)(t.payload))});if("DELETE_BOOKMARK"===t.type)return Object(l.a)(Object(l.a)({},e),{},{list:e.list.filter((function(e){return e.link!==t.payload}))});return e},serp:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{serpStart:1},t=arguments.length>1?arguments[1]:void 0;if("SEARCH_START"===t.type)return Object(l.a)(Object(l.a)({},e),{},{query:t.payload.query,serpStart:t.payload.serpStart},t.payload.serp);if("LOAD_MORE_RESULTS"===t.type)return Object(l.a)(Object(l.a)({},e),{},{items:[].concat(Object(i.a)(e.items),Object(i.a)(t.payload.serp.items))});return e}}),O=Object(u.createStore)(p,Object(b.composeWithDevTools)(Object(u.applyMiddleware)(j.a)));O.subscribe((function(){return localStorage.setItem("bookmarks",JSON.stringify(O.getState().bookmarks.list))}));var d=r(4),m=r.n(d),f=r(5);function h(e){return function(){var t=Object(f.a)(m.a.mark((function t(r){var n,c;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("https://api.telegra.ph/getPage/".concat(g(e),"?return_content=true"));case 3:return n=t.sent,t.next=6,n.json();case 6:if(c=t.sent,console.log("Logging fetchArticle response:",c.items),c.ok){t.next=10;break}throw new Error("Page not found");case 10:r({type:"ARTICLE_MODE",payload:c.result}),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(0),console.log(t.t0),r({type:"ERROR_MODE",payload:t.t0.message});case 17:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e){return t.apply(this,arguments)}}()}function g(e){return e.startsWith("https")?e.slice(19):e.slice(18)}var k=r(0);var v=function(e){var t=e.link,r=Object(s.c)((function(e){return e.bookmarks.list}));return Object(k.jsx)("button",{className:"".concat(function(e,t){return t.some((function(t){return t.link===e}))}(t,r)?"marked":""," bookmark-btn"),children:Object(k.jsx)("i",{className:"fas fa-bookmark"})})};var x=function(e){var t=e.link,r=e.img,n=e.title,c=e.snippet;return Object(k.jsxs)("div",{className:"row bookmark g-0","data-link":t,children:[Object(k.jsx)("div",{className:"col-4",children:Object(k.jsx)("img",{src:r,alt:""})}),Object(k.jsxs)("div",{className:"bookmark-text col-8",children:[Object(k.jsx)(v,{link:t}),Object(k.jsx)("h5",{children:n}),Object(k.jsx)("p",{children:c})]})]})};var y=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.bookmarks.list}));Object(n.useEffect)((function(){localStorage.bookmarks||localStorage.setItem("bookmarks",JSON.stringify([])),e({type:"ADD_BOOKMARK",payload:JSON.parse(localStorage.getItem("bookmarks"))})}),[]);var r=t.map((function(e){return Object(n.createElement)(x,Object(l.a)(Object(l.a)({},e),{},{key:e.link}))}));function c(){return(c=Object(f.a)(m.a.mark((function t(r){var n,c;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.target.closest(".bookmark")){t.next=3;break}return t.abrupt("return");case 3:if(c=n.dataset.link,!(r.target.parentElement instanceof HTMLButtonElement)){t.next=7;break}return a(c),t.abrupt("return");case 7:e(h(c));case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(k.jsxs)("div",{className:"bookmark-container col-3",onClick:function(e){return c.apply(this,arguments)},children:[Object(k.jsx)("div",{className:"bookmark-header border-left ps-2",children:Object(k.jsx)("h2",{children:"Bookmarks"})}),Object(k.jsx)("aside",{className:"bookmark-menu",children:r})]});function a(t){e({type:"DELETE_BOOKMARK",payload:t})}},E=r(6),R=r(20),S=function e(t,r,n,c){Object(R.a)(this,e),this.link=t,this.img=r,this.title=n,this.snippet=c};var w=function(e){var t=e.title,r=e.author,n=e.link,c=e.img,a=e.snippet,o=Object(s.b)(),i=Object(s.c)((function(e){return e.bookmarks.list}));return Object(k.jsxs)("header",{className:"article-header","data-link":n.toLowerCase(),"data-title":t,"data-snippet":a,"data-img":c,onClick:function(e){if(!e.target.closest("header"))return;console.log(i);var t=e.target.parentElement.classList,r=e.target.closest("header").dataset,n=r.link,c=r.img,a=r.title,s=r.snippet;if(e.target.parentElement instanceof HTMLButtonElement){if(t.contains("marked"))return t.toggle("marked"),void function(e){o({type:"DELETE_BOOKMARK",payload:e})}(n);(function(e,t){return t.some((function(t){return t.link===e}))})(n,i)||(t.toggle("marked"),function(e,t,r,n){o({type:"ADD_BOOKMARK",payload:[new S(e,t,r,n)]})}(n,c,a,s))}},children:[Object(k.jsx)(v,{link:n.toLowerCase()}),Object(k.jsx)("h3",{children:t}),Object(k.jsx)("p",{children:r})]})};var _=function e(t){var r=t.tag,c=t.children,a=void 0===c?[]:c,o=t.attrs,s=a.map((function(t,r){return"string"===typeof t?t:"\n"===t||"br"===t.tag?Object(k.jsx)("br",{}):"hr"===t.tag?Object(k.jsx)("hr",{}):"img"===t.tag?Object(n.createElement)(t.tag,{src:"".concat(t.attrs.src.startsWith("/")?"https://telegra.ph"+t.attrs.src:t.attrs.src)}):Object(n.createElement)(e,Object(l.a)(Object(l.a)({},t),{},{key:r}))}));return Object(n.createElement)(r,o,s)};var T=function(e){var t=e.article,r=Object(s.b)(),c=Object(s.c)((function(e){return e.serp.items})),a=Object(s.c)((function(e){return e.appMode.scrollPos})),o=document.querySelector(".main-container"),i=t.content.map((function(e,t){return"string"===typeof e?Object(n.createElement)("p",null,e):"img"===e.tag?Object(n.createElement)(e.tag,e.attrs):"br"===e.tag?Object(k.jsx)("br",{}):"hr"===e.tag?Object(k.jsx)("hr",{}):Object(n.createElement)(_,Object(l.a)(Object(l.a)({},e),{},{key:t}))}));return console.log(t),Object(n.useEffect)((function(){o.scrollTo(0,0)})),Object(k.jsx)("div",{className:"article-container",children:Object(k.jsxs)("article",{children:[Object(k.jsx)("button",{className:"go-back-btn btn btn-secondary",onClick:function(){o.scrollTo(0,a),r(c?{type:"SEARCH_MODE"}:{type:"EDITOR_MODE"})},children:"Go Back"}),Object(k.jsx)(w,{title:t.title,author:t.author_name,link:t.url,img:t.image_url,snippet:t.description}),i]})})};var M=function(e){var t=e.title,r=e.snippet,n=e.link,c=e.pagemap,a=c.cse_thumbnail;a=void 0===a?[]:a;var o=Object(E.a)(a,1)[0],s=(o=void 0===o?{}:o).src,i=c.cse_image;i=void 0===i?[]:i;var l=Object(E.a)(i,1)[0],u=(l=void 0===l?{}:l).src,b="/src/placeholder.png";function j(e){return e.slice(0,e.length-11)}return Object(k.jsx)("div",{className:"col mt-2 mb-3",children:Object(k.jsxs)("div",{className:"card","data-link":n.toLowerCase(),"data-img":s||u||b,"data-title":j(t),"data-snippet":r,children:[Object(k.jsx)(v,{link:n.toLowerCase()}),Object(k.jsx)("div",{className:"img-container",children:Object(k.jsx)("img",{className:"card-img-top",src:s||u||b,alt:""})}),Object(k.jsxs)("div",{className:"card-body",children:[Object(k.jsx)("h5",{children:j(t)}),Object(k.jsx)("p",{children:r})]})]})})};var N=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.bookmarks.list})),r=Object(s.c)((function(e){return e.serp.items}));return Object(k.jsx)("div",{className:"card-container row row-cols-1 row-cols-xxl-4 row-cols-xl-3 row-cols-lg-3 row-cols-md-2 row-cols-sm-1",onClick:function(e){return c.apply(this,arguments)},children:r.map((function(e,t){return Object(n.createElement)(M,Object(l.a)(Object(l.a)({},e),{},{key:t+1}))}))});function c(){return(c=Object(f.a)(m.a.mark((function r(n){var c,s,l,u,b,j,p;return m.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(c=n.target.closest(".card")){r.next=3;break}return r.abrupt("return");case 3:if(s=n.target.parentElement.classList,l=c.dataset,u=l.link,b=l.img,j=l.title,p=l.snippet,!(n.target.parentElement instanceof HTMLButtonElement)){r.next=14;break}if(!s.contains("marked")){r.next=10;break}return s.toggle("marked"),o(u),r.abrupt("return");case 10:if(i(u,t)){r.next=14;break}return s.toggle("marked"),a(u,b,j,p),r.abrupt("return");case 14:e(h(u));case 15:case"end":return r.stop()}}),r)})))).apply(this,arguments)}function a(t,r,n,c){e({type:"ADD_BOOKMARK",payload:[new S(t,r,n,c)]})}function o(t){e({type:"DELETE_BOOKMARK",payload:t})}function i(e,t){return t.some((function(t){return t.link===e}))}};var D=function(){return Object(k.jsxs)("div",{className:"welcome-msg",children:[Object(k.jsx)("h2",{children:"Welcome to threestarss' Telegra.ph Client!"}),Object(k.jsxs)("p",{children:["Use the ",Object(k.jsx)("b",{children:"left"})," input to search for articles on Telegra.ph (via Google Custom Search API), and the ",Object(k.jsx)("b",{children:"right"})," input to fetch articles with direct link (e.g. https://telegra.ph/Sample-Page-12-15) straight from Telegra.ph (via Telegra.ph API)"]}),Object(k.jsx)("p",{children:"Be careful when using Search! Telegra.ph is full of articles that contain malicious links! And unfortunately, I can't filter them out of SERP yet..."})]})};r(21);function A(e,t,r){return function(){var n=Object(f.a)(m.a.mark((function n(c){var a,o;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch("https://www.googleapis.com/customsearch/v1?key=AIzaSyBit3zVmXZThAxAnPT_j8qBnrQgRN_IrRg&cx=0d7cbe59cd07cfd30&q=".concat(e,"&start=").concat(t));case 3:return a=n.sent,n.next=6,a.json();case 6:if(o=n.sent,console.log("Logging fetchSerp response:",o.items,"Load more flag:",r),o.items){n.next=10;break}throw new Error("No results");case 10:c(r?L(o,t,e):C(o,t,e)),n.next=17;break;case 13:n.prev=13,n.t0=n.catch(0),console.log(n.t0),c({type:"ERROR_MODE",payload:""});case 17:case"end":return n.stop()}}),n,null,[[0,13]])})));return function(e){return n.apply(this,arguments)}}()}function C(e,t,r){return{type:"SEARCH_START",payload:{query:r,serp:e,serpStart:t+10}}}function L(e,t,r){return{type:"LOAD_MORE_RESULTS",payload:{query:r,serp:e,serpStart:t+10}}}var B=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.appMode.mode})),r=Object(s.c)((function(e){return e.article})),n=Object(s.c)((function(e){return e.serp.serpStart})),c=Object(s.c)((function(e){return e.serp.query}));return Object(k.jsx)("main",{className:"content-container container-fluid g-0",children:Object(k.jsxs)("div",{id:"parent",children:[null===t&&Object(k.jsx)(D,{}),!0===t&&Object(k.jsx)(T,{article:r}),!1===t&&Object(k.jsx)(N,{}),!1===t&&Object(k.jsx)("button",{className:"btn btn-secondary",onClick:function(e){return a.apply(this,arguments)},id:"loadmore",children:"Load More Results"})]})});function a(){return(a=Object(f.a)(m.a.mark((function t(r){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e(A(c,n,1));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}};function K(e){var t=e.children,r=Object(s.b)();return Object(k.jsx)("header",{className:"bg-dark container-fluid align-items-center pe-0 g-0",children:Object(k.jsx)("div",{className:"row row-height",children:Object(k.jsxs)("div",{className:"header-menu col justify-content-between",children:[Object(k.jsx)("img",{className:"logo",alt:"logo",src:"./icon.png",onClick:function(){r({type:"EDITOR_MODE"})},width:"35",height:"35"}),t]})})})}var I=function(e){var t=e.handleChange,r=e.handleSubmit,n=e.placeholder;return Object(k.jsx)("form",{className:"input",onSubmit:r,children:Object(k.jsx)("input",{className:"input",type:"text",placeholder:n,onChange:t})})};var P=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.appMode.errorType})),r=Object(n.useRef)(null),c=Object(n.useRef)(null),o=document.querySelector("#error-root");if(!c.current){var i=document.createElement("div");c.current=i}return Object(n.useEffect)((function(){o.append(c.current),r.current=setTimeout((function(){e({type:"ERROR_MODE"}),o.removeChild(c.current)}),3500)}),[]),Object(a.createPortal)(Object(k.jsx)("div",{className:"error",onClick:function(t){clearTimeout(r.current),e({type:"ERROR_MODE",payload:""}),o.removeChild(c.current)},children:Object(k.jsx)("p",{children:t})}),c.current)};var q=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.appMode.error})),r=Object(n.useState)(""),c=Object(E.a)(r,2),a=(c[0],c[1],Object(n.useState)("")),o=Object(E.a)(a,2),i=o[0],l=o[1],u=document.querySelector(".main-container");return Object(k.jsxs)("div",{className:"main-container col-9",onClick:function(t){if(!t.target.closest(".card"))return;e({type:"SET_SCROLL_POS",payload:u.scrollTop})},children:[Object(k.jsx)(K,{children:Object(k.jsx)(I,{placeholder:"Telegra.ph search...",handleSubmit:function(e){return b.apply(this,arguments)},handleChange:function(e){l(e.target.value)}})}),t&&Object(k.jsx)(P,{}),Object(k.jsx)(B,{})]});function b(){return(b=Object(f.a)(m.a.mark((function t(r){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),t.next=3,e(A(i,1));case 3:e({type:"SEARCH_MODE"});case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}};var H=function(){return Object(k.jsx)(s.a,{store:O,children:Object(k.jsxs)("div",{className:"row",children:[Object(k.jsx)(q,{}),Object(k.jsx)(y,{})]})})};o.a.render(Object(k.jsx)(c.a.StrictMode,{children:Object(k.jsx)(H,{})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.2c1f9f22.chunk.js.map